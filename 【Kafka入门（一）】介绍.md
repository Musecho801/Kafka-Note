# 【Kafka入门（一）】介绍

Kafka学习的参考资料：

官网：https://kafka.apache.org/documentation/#majordesignelements

尚硅谷视频：https://www.bilibili.com/video/BV1a4411B7V9

尚硅谷视频笔记：https://my.oschina.net/jallenkwong/blog/4449224#h2_1

书籍：深入理解Kafka_核心设计与实践原理

<br>

<br>

### 1.什么是事件流

从数据库、感应器、云服务等，实时抓取数据；

并存储数据，以便之后的检索；

实时、回顾性地操作、处理和响应事件流；

并根据需要将事件流路由到不同的目标技术。

事件流保证了在对的时间、对的地点，出现正确的数据。

<br>

### 2.用来做什么

实时处理支付、金融交易

手机中的地理位置更新

跟踪、监控车辆，例如物流

<br>

### 3.kafka介绍

#### 1）kafka是一个事件流平台

- **发布**（写）、**订阅**（读）事件流
- **存储**持久和可靠的事件流
- 当事件发生时或追溯性地，**处理**事件流

<br>

#### 2）分布式系统

Kafka 是一个分布式系统，由通过高性能 TCP 网络协议 进行通信的**服务器**和**客户端**组成。它可以部署在预置环境或云环境中的裸机硬件、虚拟机和容器上。

- 服务器：一些服务形成存储层，被称为代理broker。其他的服务器运行`Kafka Connect`，已将数据作为事件流持续导入和导出。

- 客户端：允许我们编写分布式应用程序和微服务，它们可以并行、大规模、以容错的方式，读取、写入和处理事件流。

<br>

#### 3）主要概念

1.事件

当要向 Kafka 读取或写入数据时，要以**事件**的形式执行操作。

- Event key: "Alice"
- Event value: "Made a payment of $200 to Bob"
- Event timestamp: "Jun. 25, 2020 at 2:06 p.m."

<br>

2.生产者与消费者

**生产者**是那些向 Kafka 发布（写入）事件的客户端应用程序，**消费者**是订阅（读取和处理）这些事件的客户端应用程序。

在 Kafka 中，生产者和消费者完全解耦并且彼此不可知。所以，生产者永远不需要等待消费者。

<br>

3.事件和主题

**事件**被组织并持久地存储在**主题**中。主题类似于文件系统中的文件夹，事件类似于文件夹中的文档。

Kafka 中的主题可以是多生产者和多订阅者的。

<br>

4.分区

主题是**分区的**，这意味着一个主题分布在位于不同 Kafka 代理的多个“桶”上。

客户端应用程序同时从/向多个代理读取和写入数据。

<br>

5.复制

为了使您的数据具有容错性和高可用性，每个主题都可以**复制**，以便始终有多个代理拥有数据副本。

<br>

### 4.消费模式

消息队列的两种模式

<br>

#### 1）点对点模式

**一对一，消费者主动拉取数据，消息收到后消息清除**

生产者生产消息发送到Queue中，然后消费者从Queue取出消息并消费。消息被消费后， Queue 中不再存储，所以消费者不可能消费到已经被消费的消息。Queue 支持存在多个消费者，但是对一个消息而言，只会有一个消费者可以消费。

![](https://img2020.cnblogs.com/blog/1491599/202111/1491599-20211104094021394-1552923037.png)

<br>

#### 2）发布/订阅模式

**一对多，消费者消费数据之后不会清除消息**

消息生产者（发布）将消息发布到 topic 中，同时有多个消息消费者（订阅）消费该消息。和点对点方式不同，发布到 topic 的消息会被所有订阅者消费。

数据不会一直存在topic中，可以设置缓存时间。

![](https://img2020.cnblogs.com/blog/1491599/202111/1491599-20211104094327110-155093129.png)

<br>

发布/订阅模式 分2种模式：

1.队列推送消息

缺点：消费者可能过载，可能资源浪费。

2.消费者拉取消息

缺点：消费者需要不断询问topic是否有消息

<br>

***Kafka属于 发布/订阅模式的 消费者拉取消息模式。**

<br>

### 5.Kafka APIs

1）`Producer` API：允许应用将数据流**发送**到Kafka集群的主题中

2）`Consumer` API：允许应用从Kafka集群的主题中**读取**数据流

3）`Streams` API：将输入主题的数据流**转换**为输出主题中

4）`Connect` API：实现**连接器**，持续从一些源系统或应用拉取数据到Kafka中，或推送Kafka中的数据到一些槽系统或应用

5）`Admin` API：**管理或检查**主题，代理，和其他Kafka对象

